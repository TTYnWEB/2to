var a=document.documentElement,b=document.getElementById('form'),c=document.getElementById('clip-r'),d=document.getElementById('clip-w'),A=document.getElementById('copy'),f=document.getElementById('url'),g=document.getElementById('theme-toggle'),h=document.getElementById('submit-btn'),i=document.getElementById('short-url'),j=document.getElementById('modal-short-url'),k=document.querySelector('[aria-label="Close"]'),l=_=>{a.setAttribute('data-theme',_);localStorage.setItem('theme',_)},m=e=>e.target.select(),n=async _a=>navigator.permissions.query({name:_a}),o=async (D,_b,_c)=>{const _d=localStorage.getItem(_b);if(!_d)return null;const{state:E}=await n(_c);if(E!=='granted'){D.checked=!1;return null}D.checked=(_d==='true')},p=async ()=>{const _A=f.value;const _B=await fetch('/api/add',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url:_A})}).then(res=>res.json()).then(aA=>{i.value=`https://2to.co/${aA.key}`;j.showModal();const aB=(localStorage.getItem('clip-w')==='true');console.log({isClipW:aB},`val: ${i.value}`);aB&&navigator.clipboard.writeText(i.value);i.select()})},q=()=>{if(!f.value.length){f.removeAttribute('aria-invalid');return null}const aC=aD=>{h.disabled=aD;f.setAttribute('aria-invalid',aD)};f.validity.valid?aC(!1):aC(!0)};g.addEventListener('change',()=>{g.checked?l('light'):l('dark')});f.addEventListener('input',q);b.addEventListener('submit',e=>{e.preventDefault();p()});c.addEventListener('change',async ()=>await navigator.clipboard.readText().then(()=>{c.checked=!0;localStorage.setItem('clip-r','true')}).catch(()=>{c.checked=!1;localStorage.setItem('clip-r','false')}));d.addEventListener('change',async ()=>(localStorage.setItem('clip-w',d.checked?'true':'false')));i.addEventListener('click',m);i.addEventListener('touchstart',m);document.addEventListener('click',e=>{var aG=j.open,_D=_C.contains(e.target);if(!aG)return;var _C=j.querySelector('article');!_D&&j.close()});document.addEventListener('keydown',e=>{var aH=(()=>j.open);(aH&&(e.key==='Escape'))&&j.close()});k.addEventListener('click',()=>j.close());A.addEventListener('click',()=>(navigator.clipboard.writeText(i.value)));(()=>{var B=localStorage.getItem('theme');if(B){a.setAttribute('data-theme',B);g.checked=(B==='light')}else{var C=window.matchMedia('(prefers-color-scheme: dark)').matches;a.setAttribute('data-theme',C?'dark':'light');g.checked=!C;localStorage.setItem('theme',C?'dark':'light')}})();(()=>{o(c,'clip-r','clipboard-read');o(d,'clip-w','clipboard-write')})();(async ()=>{const{state:aE}=await navigator.permissions.query({name:'clipboard-read'});if(aE!=='granted')return null;var aF=(localStorage.getItem('clip-r')==='true');aF&&(f.value=await navigator.clipboard.readText(),q(),f.focus())})();
